(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,n){},112:function(e,t,n){},114:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(2),o=n.n(c),i=(n(42),n(1)),l=(n(44),n(31)),s=n(10),u=(n(55),r.a.forwardRef(function(e,t){var n=e.className,a=Object(s.a)(e,["className"]);return r.a.createElement("input",Object.assign({ref:t,className:"input ".concat(n)},a))})),p=r.a.createContext(),m=p.Provider;function f(){return Object(a.useContext)(p)}var d=r.a.createContext(),h=d.Provider;function v(){return Object(a.useContext)(d)}var g={types:["establishment"]},E=function(e){var t=e.onPlaceChanged,n=e.className,c=e.options,o=void 0===c?g:c,i=Object(s.a)(e,["onPlaceChanged","className","options"]),l=v(),p=Object(a.useRef)(),m=Object(a.useRef)(),d=f();Object(a.useEffect)(function(){m.current=new l.maps.places.Autocomplete(p.current,o)},[]),Object(a.useEffect)(function(){return m.current.bindTo("bounds",d)},[d]),Object(a.useEffect)(function(){var e=m.current.addListener("place_changed",h);return function(){return l.maps.event.removeListener(e)}});var h=function(){var e=m.current.getPlace();t(e)};return r.a.createElement("div",{className:n},r.a.createElement(u,Object.assign({ref:p},i)))};n(57);var b=["photos","formatted_address","name","rating","opening_hours","geometry"],y=function(e){var t=e.onPlacesResult,n=v(),c=f(),o=function(e){var t=v(),n=Object(a.useState)(new t.maps.places.PlacesService(e)),r=Object(i.a)(n,2),c=r[0],o=r[1];return Object(a.useEffect)(function(){return o(new t.maps.places.PlacesService(e))},[e]),c}(c),l=Object(a.useState)(null),s=Object(i.a)(l,2),u=s[0],p=s[1],m=function(e){var a={query:e,fields:b,bounds:c.getBounds()};o.textSearch(a,function(e,a){a===n.maps.places.PlacesServiceStatus.OK?t(e):a===n.maps.places.PlacesServiceStatus.ZERO_RESULTS&&alert("No results")})};return r.a.createElement("form",{className:"main-form",onSubmit:function(e){e.preventDefault(),m(u)}},r.a.createElement(E,{className:"main-form__place-input",placeholder:"search places with autocomplete!",onPlaceChanged:function(e){e.geometry?t([e]):m(e.name)},onChange:function(e){p(e.target.value)}}),r.a.createElement("button",{className:"main-form__submit fas fa-search",type:"submit"}))},w=(n(59),r.a.forwardRef(function(e,t){return r.a.createElement("div",{ref:t,className:"map"})}));var j=n(8),O=n.n(j),k=n(9),P=n.n(k);n(110),n(112);var S=function(e){var t=e.rate,n=e.max,a=void 0===n?5:n,c=Math.round(t/a*100);return r.a.createElement("div",{className:"rating"},r.a.createElement("div",{className:"rating--colored",style:{width:c+"%"}},r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605")),r.a.createElement("div",null,r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605"),r.a.createElement("span",null,"\u2605")))};var _,C=function(e){var t=e.place,n=O()(t,"photos[0].getUrl"),a=P()(t,"opening_hours.open_now");return r.a.createElement("div",{className:"marker-details"},r.a.createElement("div",{className:"marker-details__cover"},n&&r.a.createElement("img",{alt:"place cover",src:n}),r.a.createElement("h1",null,t.name)),t.rating&&r.a.createElement("div",{className:"marker-details__rating"},r.a.createElement(S,{rate:t.rating}),"(",t.rating,")"),void 0!==a&&r.a.createElement("p",null,"Open now: ",a?"Yes":"No"),"Click to see more!")},N=n(32),R=n(35),L=n(33),M=n(36),x=n(16),A=function e(){Object(x.a)(this,e)};function D(){var e=v();return _||(!function(e){A=function(e){function t(){return Object(x.a)(this,t),Object(R.a)(this,Object(L.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(N.a)(t,[{key:"onAdd",value:function(){this.getPanes().floatPane.appendChild(this.anchor)}},{key:"onRemove",value:function(){this.anchor.parentElement&&this.anchor.parentElement.removeChild(this.anchor)}},{key:"open",value:function(e,t){this.setMap(e),this.marker=t}},{key:"close",value:function(){this.setMap(null)}},{key:"setContent",value:function(e){var t=document.createElement("div");t.classList.add("popup-bubble-anchor"),t.appendChild(e),this.anchor=document.createElement("div"),this.anchor.classList.add("popup-tip-anchor"),this.anchor.appendChild(t),this.stopEventPropagation()}},{key:"draw",value:function(){var e=this.getProjection().fromLatLngToDivPixel(this.marker.getPosition());e.x+=this.marker.anchorPoint.x,e.y+=this.marker.anchorPoint.y;var t=Math.abs(e.x)<4e3&&Math.abs(e.y)<4e3?"block":"none";"block"===t&&(this.anchor.style.left=e.x+"px",this.anchor.style.top=e.y+"px"),this.anchor.style.display!==t&&(this.anchor.style.display=t)}},{key:"stopEventPropagation",value:function(){var e=this.anchor;e.style.cursor="auto",["click","dblclick","contextmenu","wheel","mousedown","touchstart","pointerdown"].forEach(function(t){e.addEventListener(t,function(e){e.stopPropagation()})})}}]),t}(e.maps.OverlayView)}(e),_=new A),_}var W=function(e){var t=e.place,n=e.location,c=e.onClick,i=Object(a.useRef)(document.createElement("div")),l=D(),s=v(),u=f(),p=function(e,t){var n=v(),r=Object(a.useRef)(new n.maps.Marker({map:e,animation:n.maps.Animation.DROP}));return Object(a.useEffect)(function(){return r.current.setMap(e)},[e]),Object(a.useEffect)(function(){return function(){return r.current.setMap(null)}},[]),Object(a.useEffect)(function(){t&&r.current.setPosition(t),r.current.setVisible(!!t)},[t]),r}(u,n);Object(a.useEffect)(function(){var e=s.maps.event.addListener(p.current,"click",c),t=s.maps.event.addListener(p.current,"mouseover",m),n=s.maps.event.addListener(p.current,"mouseout",d);return function(){s.maps.event.removeListener(e),s.maps.event.removeListener(t),s.maps.event.removeListener(n)}});var m=function(){o.a.render(r.a.createElement(C,{place:t}),i.current),l.setContent(i.current),l.open(u,p.current)},d=function(){l.close()};return null};n(114);function T(e){var t=e.nearbyWikipediaPages;return t?r.a.createElement("section",{className:"place-details__wikipedia"},r.a.createElement("h2",null,"Nearby Wikipedia pages:"),0===t.length?"No pages nearby":r.a.createElement("ul",null,t.map(function(e){return r.a.createElement("li",{key:e.pageid},r.a.createElement("a",{title:e.title,href:"http://en.wikipedia.org/?curid=".concat(e.pageid)},e.title))}))):null}function U(e){var t=e.rating;return void 0===t?null:r.a.createElement("section",{className:"place-details__rating"},r.a.createElement(S,{rate:t})," (",t,")")}var I=function(e){var t=e.place,n=e.onClose;if(!t)return null;var a=O()(t,"photos[0].getUrl");return r.a.createElement("div",{role:"dialog","aria-label":"".concat(t.name," details"),"aria-modal":"true",className:"place-details"},r.a.createElement("button",{"aria-label":"close",className:"place-details__close fas fa-times",onClick:n}),r.a.createElement("div",{className:"place-details__cover"},a&&r.a.createElement("img",{alt:"place cover",src:a}),r.a.createElement("h1",null,t.name)),r.a.createElement("div",{className:"place-details__content"},r.a.createElement("section",null,t.formatted_address),r.a.createElement(U,{rating:t.rating}),r.a.createElement(T,{nearbyWikipediaPages:t.nearbyWikipediaPages})))},B=n(3);function q(e){return function(t){return{type:e,payload:t}}}var V=n(17),z=n.n(V),H=n(34),J={encode:function(e){var t=Object.keys(e);return t.reduce(function(n,a,r){var c=encodeURI(e[a]);return n+="".concat(a,"=").concat(c),r<t.length-1&&(n+="&"),n},"?")}},Z={headers:{"Content-type":"application/json",Accept:"application/json"}};function G(){return(G=Object(H.a)(z.a.mark(function e(t,n){var a,r,c;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t,"|").concat(n),r=J.encode({action:"query",list:"geosearch",gscoord:a,gsradius:1e3,gslimit:5,origin:"*",format:"json"}),e.next=4,fetch("https://en.wikipedia.org/w/api.php"+r,Z);case 4:return c=e.sent,e.abrupt("return",c.json());case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var K="MAP_INIT",X="SEARCH_RESULT",Y="PLACE_SELECTED",$="HIDE_PLACE_DETAILS",F={initMap:q(K),searchResult:q(X),placeSelected:q(Y),hidePlaceDetails:q($)},Q={getMap:function(e){return e.map},getShowPlaceDetails:function(e){return e.showPlaceDetails},getPlaceSelected:function(e){return e.placeSelected},getSearchResults:function(e){return e.searchResults}},ee={center:{lat:-25.479,lng:-49.228},zoom:15},te={map:null,searchResults:[],placeSelected:null,showPlaceDetails:!1};function ne(e,t){switch(t.type){case K:return Object(B.a)({},e,{map:t.payload});case X:return Object(B.a)({},e,{searchResults:t.payload});case Y:return Object(B.a)({},e,{placeSelected:t.payload,showPlaceDetails:!0});case $:return Object(B.a)({},e,{showPlaceDetails:!1});default:return e}}function ae(e){var t=v(),n=Object(a.useReducer)(ne,te),r=Object(i.a)(n,2),c=r[0],o=r[1],l=Q.getMap(c),s=Q.getSearchResults(c),u=Q.getPlaceSelected(c);return Object(a.useEffect)(function(){o(F.initMap(new t.maps.Map(e.current,ee)))},[]),Object(a.useEffect)(function(){1===s.length&&(s[0].geometry.viewport?l.fitBounds(s[0].geometry.viewport):(l.setCenter(s[0].geometry.location),l.setZoom(17)))},[s]),Object(a.useEffect)(function(){if(l){var e=l.addListener("click",function(){return o(F.hidePlaceDetails())});return function(){return t.maps.event.removeListener(e)}}}),Object(a.useEffect)(function(){if(u&&!u.nearbyWikipediaPages){var e=u.geometry.location;(function(e,t){return G.apply(this,arguments)})(e.lat(),e.lng()).then(function(e){o(F.placeSelected(Object(B.a)({},u,{nearbyWikipediaPages:P()(e,"query.geosearch")})))})}},[u]),[c,o]}var re,ce=function(){var e=Object(a.useRef)(null),t=ae(e),n=Object(i.a)(t,2),c=n[0],o=n[1];return r.a.createElement(m,{value:Q.getMap(c)},r.a.createElement("div",{className:"home"},Q.getMap(c)&&r.a.createElement(y,{onPlacesResult:function(e){o(F.searchResult(e))}}),r.a.createElement(w,{ref:e}),Q.getSearchResults(c).map(function(e){return r.a.createElement(W,{place:e,location:e.geometry.location,key:e.reference,onClick:function(e){return function(){o(F.placeSelected(e))}}(e)})}),r.a.createElement(l.CSSTransition,{in:Q.getShowPlaceDetails(c),timeout:500,classNames:"place-details__animation",unmountOnExit:!0},r.a.createElement(I,{place:Q.getPlaceSelected(c),onClose:function(){o(F.hidePlaceDetails())}}))))},oe=["places"];var ie=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function le(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(function(){var e=Object(a.useState)(),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)(function(){(re||(re=new Promise(function(e){window._initMap=function(){return e(window.google)};var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyDdMMa6SAaW7VG0fgereh93XyS_43BjS_c","&libraries=").concat(oe.join(","),"&callback=_initMap"),t.defer=!0,t.async=!0,document.body.appendChild(t)})),re).then(c)},[]),r.a.createElement(h,{value:n},n?r.a.createElement(ce,null):"loading")},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/udacity-final-project",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/udacity-final-project","/service-worker.js");ie?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):le(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):le(t,e)})}}()},37:function(e,t,n){e.exports=n(118)},42:function(e,t,n){},44:function(e,t,n){},55:function(e,t,n){},57:function(e,t,n){},59:function(e,t,n){}},[[37,2,1]]]);
//# sourceMappingURL=main.ba9a9ddc.chunk.js.map